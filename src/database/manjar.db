USE MANJAR
GO;

CREATE TABLE USER (
    USER_ID INT PRIMARY KEY AUTO_INCREMENT,
    USER_NAME VARCHAR(60) NOT NULL UNIQUE,
    USER_MAIL VARCHAR(255) NOT NULL,
    USER_PASSWORD VARCHAR(60) NOT NULL
);

CREATE TABLE CATEGORY (
    CAT_ID INT PRIMARY KEY AUTO_INCREMENT,
    CAT_DESC VARCHAR(60)
);

CREATE TABLE PRODUCT (
    PRODUCT_ID INT PRIMARY KEY AUTO_INCREMENT, 
    PRODUCT_SKU VARCHAR(60) NOT NULL UNIQUE,
    PRODUCT_DESC VARCHAR(155) NOT NULL,
    PRODUCT_CAT_ID INT,
    CONSTRAINT fk_Cat_id FOREIGN KEY (PRODUCT_CAT_ID) REFERENCES CATEGORY (CAT_ID) MATCH SIMPLE
);

/*============================================================================*/
/*============= CREO UNA FUNCION PARA QUE ME DIGA SI EXISTE EL USUARIO =======*/
/*============================================================================*/
DELIMITER $$

CREATE FUNCTION fn_exists_mail (MAIL VARCHAR(255))
RETURNS BIT
BEGIN
    DECLARE result BIT;

    IF NOT EXISTS (SELECT * FROM USER WHERE USER_MAIL = MAIL) THEN
        SET result = 0;
    ELSE
        SET result = 1;
    END IF;

    RETURN result;
END$$

DELIMITER ;

/*============================================================================*/